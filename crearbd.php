<?php

$query="CREATE TABLE `elecciones`( `id` int(11) NOT NULL, `descripcion` text COLLATE utf8_spanish_ci NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `encuestas` ( `id` int(11) NOT NULL, `titulo` text COLLATE utf8_spanish_ci NOT NULL, `fecha_inicio` varchar(100) COLLATE utf8_spanish_ci NOT NULL, `fecha_cierre` varchar(100) COLLATE utf8_spanish_ci NOT NULL, `fecha_creacion` varchar(100) COLLATE utf8_spanish_ci NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `encuesta_x_usuario` ( `encuesta_id` int(11) NOT NULL, `usuario_id` int(11) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `opciones` ( `id` int(11) NOT NULL, `eleccion_id` int(11) NOT NULL, `tipo_id` int(11) NOT NULL, `pregunta_id` int(11) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `preguntas` ( `id` int(11) NOT NULL, `descripcion` text COLLATE utf8_spanish_ci NOT NULL, `encuesta_id` int(11) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `respuestas` ( `id` int(11) NOT NULL, `opcion_id` int(11) NOT NULL, `estado` varchar(255) COLLATE utf8_spanish_ci NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `tipos` ( `id` int(11) NOT NULL, `clase` text COLLATE utf8_spanish_ci NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; CREATE TABLE `usuarios` ( `id` int(11) NOT NULL, `nombre` varchar(200) COLLATE utf8_spanish_ci NOT NULL, `password` varchar(20) COLLATE utf8_spanish_ci NOT NULL, `tipo` varchar(30) COLLATE utf8_spanish_ci NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_spanish_ci; ALTER TABLE `elecciones` ADD PRIMARY KEY (`id`); ALTER TABLE `encuestas` ADD PRIMARY KEY (`id`); ALTER TABLE `encuesta_x_usuario` ADD KEY `encuesta_id` (`encuesta_id`), ADD KEY `usuario_id` (`usuario_id`); ALTER TABLE `opciones` ADD PRIMARY KEY (`id`), ADD KEY `eleccion_id` (`eleccion_id`), ADD KEY `tipo_id` (`tipo_id`), ADD KEY `pregunta_id` (`pregunta_id`); ALTER TABLE `preguntas` ADD PRIMARY KEY (`id`), ADD KEY `encuesta_id` (`encuesta_id`); ALTER TABLE `respuestas` ADD PRIMARY KEY (`id`), ADD KEY `opcion_id` (`opcion_id`); ALTER TABLE `tipos` ADD PRIMARY KEY (`id`); ALTER TABLE `usuarios` ADD PRIMARY KEY (`id`); ALTER TABLE `elecciones` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `encuestas` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `opciones` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `preguntas` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `respuestas` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `tipos` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `usuarios` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT; ALTER TABLE `encuesta_x_usuario` ADD CONSTRAINT `encuesta_x_usuario_ibfk_1` FOREIGN KEY (`usuario_id`) REFERENCES `usuarios` (`id`), ADD CONSTRAINT `encuesta_x_usuario_ibfk_2` FOREIGN KEY (`encuesta_id`) REFERENCES `encuestas` (`id`); ALTER TABLE `opciones` ADD CONSTRAINT `opciones_ibfk_1` FOREIGN KEY (`tipo_id`) REFERENCES `tipos` (`id`), ADD CONSTRAINT `opciones_ibfk_2` FOREIGN KEY (`eleccion_id`) REFERENCES `elecciones` (`id`), ADD CONSTRAINT `opciones_ibfk_3` FOREIGN KEY (`pregunta_id`) REFERENCES `preguntas` (`id`); ALTER TABLE `preguntas` ADD CONSTRAINT `preguntas_ibfk_1` FOREIGN KEY (`encuesta_id`) REFERENCES `encuestas` (`id`); ALTER TABLE `respuestas` ADD CONSTRAINT `respuestas_ibfk_1` FOREIGN KEY (`opcion_id`) REFERENCES `opciones` (`id`); COMMIT;";

global $dbh;
 // connection to the database
 try {
 $dbh = new PDO('mysql:host=localhost;dbname=c2mrappencuesta', 'c2mrappencuesta', 'mg7KLmec#FR');
 } catch(Exception $e) {
  exit("Error conectando al Servidor");
 }
 // Execute the query
 $resultat = $dbh->query($query) or die(print_r($dbh->errorInfo()));



?>
